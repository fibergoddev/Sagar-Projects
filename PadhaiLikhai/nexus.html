<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus Hub | PadhaiLikhai by Sagar Raj</title>
    <link rel="stylesheet" href="nexus.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icon-512.png">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Designed & Developed by Sagar Raj -->
    
    <!-- Main application shell -->
    <div id="app-shell">
        <!-- Animated Loader -->
        <div id="loader-overlay" class="visible">
            <svg id="logo-loader" width="100" height="100" viewBox="0 0 100 100">
                <path class="logo-path" d="M 20 20 L 20 80 L 50 80 L 50 50 L 40 50" fill="none" stroke-width="5"/>
                <path class="logo-path" d="M 50 20 L 80 20 L 80 80" fill="none" stroke-width="5"/>
            </svg>
            <div id="loader-status">Entering the Nexus...</div>
        </div>

        <!-- The Main Nexus Hub View -->
        <div id="nexus-hub-view" class="view hidden">
            <div class="nexus-hub-content">
                <div class="nexus-sidebar">
                    <div class="nexus-profile-pod">
                        <div class="nexus-avatar" id="nexus-user-avatar">S</div>
                        <h3 id="nexus-user-name">Loading...</h3>
                        <div class="nexus-stats">
                            <div class="nexus-stat-item" title="Nexus Points"><i class="fas fa-star"></i><span id="nexus-user-points">0</span> NP</div>
                            <div class="nexus-stat-item" title="Daily Streak"><i class="fas fa-fire"></i><span id="nexus-user-streak">0</span> Days</div>
                        </div>
                    </div>
                    <div id="user-badges-container" class="badges-container">
                        <!-- Badges will be loaded here -->
                    </div>
                    <nav class="nexus-nav">
                        <button class="nexus-nav-btn active" data-target="nexus-missions-view"><i class="fas fa-tasks"></i> Daily Missions</button>
                        <button class="nexus-nav-btn" data-target="nexus-squad-view"><i class="fas fa-users"></i> My Squad</button>
                        <button class="nexus-nav-btn" data-target="nexus-leaderboard-view"><i class="fas fa-trophy"></i> Leaderboards</button>
                    </nav>
                    <a href="index.html" class="back-to-hub-btn"><i class="fas fa-arrow-left"></i> Back to Main Hub</a>
                </div>
                <div class="nexus-main-view">
                    <!-- Daily Missions View -->
                    <div id="nexus-missions-view" class="nexus-view active">
                        <h2>Daily Missions</h2>
                        <p class="nexus-subtitle">Complete missions to earn bonus Nexus Points and maintain your streak!</p>
                        <div id="daily-missions-list" class="missions-list">
                            <div class="mission-item placeholder"></div><div class="mission-item placeholder"></div><div class="mission-item placeholder"></div>
                        </div>
                    </div>
                    <!-- My Squad View -->
                    <div id="nexus-squad-view" class="nexus-view">
                        <div id="no-squad-view">
                            <h2>Join a Squad!</h2><p class="nexus-subtitle">Team up with friends to compete and earn rewards together.</p>
                            <div class="squad-actions"><div class="squad-action-box"><h3>Create a Squad</h3><form id="create-squad-form"><input type="text" id="create-squad-name" placeholder="Enter Squad Name" required maxlength="20"><button type="submit" class="styled-button">Create</button></form></div><div class="squad-action-box"><h3>Join a Squad</h3><form id="join-squad-form"><input type="text" id="join-squad-code" placeholder="Enter Squad Code" required maxlength="6"><button type="submit" class="styled-button">Join</button></form></div></div>
                        </div>
                        <div id="in-squad-view" class="hidden">
                            <div class="squad-header"><h2 id="squad-name-display"></h2><div class="squad-total-points"><i class="fas fa-star"></i> <span id="squad-points-display">0</span> NP</div></div>
                            <div class="squad-invite"><span>Invite Code:</span><input type="text" id="squad-invite-code" readonly><button id="copy-squad-code-btn"><i class="fas fa-copy"></i></button></div>
                            <h3>Squad Members (<span id="squad-member-count">0</span>/4)</h3>
                            <div id="squad-members-list" class="squad-members-list"></div>
                            <div id="squad-management-panel" class="hidden"><h3>Admin Controls</h3><button id="delete-squad-btn" class="styled-button danger-button">Delete Squad</button></div>
                            <button id="leave-squad-btn" class="styled-button danger-button">Leave Squad</button>
                        </div>
                    </div>
                    <!-- Leaderboard View -->
                    <div id="nexus-leaderboard-view" class="nexus-view">
                        <h2>Leaderboards</h2>
                        <div class="leaderboard-tabs"><button class="leaderboard-tab-btn active" data-target="leaderboard-global">Global</button><button class="leaderboard-tab-btn" data-target="leaderboard-local">Local</button><button class="leaderboard-tab-btn" data-target="leaderboard-squads">Squads</button></div>
                        <div id="leaderboard-global" class="leaderboard-content active"></div><div id="leaderboard-local" class="leaderboard-content"></div><div id="leaderboard-squads" class="leaderboard-content"></div>
                        <div id="leaderboard-ad-slot" class="ad-slot-native"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="reward-overlay" class="hidden"><div class="reward-content"><div class="reward-title">Mission Complete!</div><div class="reward-points">+50 NP</div><div class="reward-particles"></div></div></div>
    <div id="notification-container"></div>
    
    <!-- ** THE FIX **: New, Unbreakable Loading Sequence for the Nexus Hub -->
    <!-- Step 1: Load the dedicated Nexus initialization script first. -->
    <script src="nexus-init.js" type="module"></script>
    <!-- Step 2: Load the main Nexus application script, which will wait for the signal. -->
    <script src="nexus.js" type="module"></script>

</body>
</html>
